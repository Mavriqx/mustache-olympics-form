<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2025 Mustache Olympics Submission</title>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; line-height: 1.6; color: #333; max-width: 600px; margin: 40px auto; padding: 0 20px; }
        .title-container { display: flex; justify-content: center; align-items: center; gap: 15px; margin-bottom: 20px; }
        .logo { max-width: 80px; height: auto; }
        h1 { color: #111; margin: 0; }
        p { text-align: left; }
        form { display: flex; flex-direction: column; gap: 20px; text-align: left; }
        label { font-weight: bold; }
        .optional-label { font-weight: normal; font-style: italic; color: #666; font-size: 0.9em; margin-left: 5px; }
        input[type="text"], input[type="email"], input[type="tel"], select { padding: 10px; border: 1px solid #ccc; border-radius: 5px; font-size: 16px; width: 100%; box-sizing: border-box; }
        /* --- START: Color Change --- */
        button { padding: 12px 20px; background-color: #7B1E25; color: white; border: none; border-radius: 5px; font-size: 16px; cursor: pointer; transition: background-color 0.2s; }
        button:hover { background-color: #61181E; }
        /* --- END: Color Change --- */
        button:disabled { background-color: #ccc; cursor: not-allowed; }
        .consent-group { display: flex; align-items: flex-start; gap: 10px; margin-top: 10px; }
        .consent-group input { margin-top: 5px; }
        #status { margin-top: 20px; padding: 15px; border-radius: 5px; text-align: center; display: none; }
        .success { background-color: #d4edda; color: #155724; }
        .error { background-color: #f8d7da; color: #721c24; }
        fieldset { border: none; padding: 0; margin: 0; display: flex; flex-direction: column; gap: 15px; }
        legend { font-size: 1.2em; font-weight: bold; color: #111; margin-bottom: 15px; padding: 0; width: 100%; border-bottom: 1px solid #ccc; padding-bottom: 10px; }
        .form-blurb { font-size: 0.9em; color: #555; margin: -10px 0 10px 0; }
    </style>
    <script src="https://ucarecdn.com/libs/widget/3.x/uploadcare.full.min.js" charset="utf-8"></script>
</head>
<body>
    <div class="title-container">
        <img src="Black.png" alt="Mustache Olympics Logo" class="logo">
        <h1>Mustache Olympics Submission</h1>
    </div>
    <p>Complete the form below to submit your official entry. Good luck!</p>
    <form id="contest-form">
        <input type="hidden" id="email" name="email">
        <fieldset>
            <legend>Required Information</legend>
            <div><label for="firstName">First Name</label><input type="text" id="firstName" name="firstName" required></div>
            <div><label for="lastName">Last Name</label><input type="text" id="lastName" name="lastName" required></div>
            <div><label for="city">City</label><input type="text" id="city" name="city" required></div>
            <div><label for="state">U.S. State</label><select id="state" name="state" required><option value="">Select a State</option><option value="AL">Alabama</option><option value="AK">Alaska</option><option value="AZ">Arizona</option><option value="AR">Arkansas</option><option value="CA">California</option><option value="CO">Colorado</option><option value="CT">Connecticut</option><option value="DE">Delaware</option><option value="FL">Florida</option><option value="GA">Georgia</option><option value="HI">Hawaii</option><option value="ID">Idaho</option><option value="IL">Illinois</option><option value="IN">Indiana</option><option value="IA">Iowa</option><option value="KS">Kansas</option><option value="KY">Kentucky</option><option value="LA">Louisiana</option><option value="ME">Maine</option><option value="MD">Maryland</option><option value="MA">Massachusetts</option><option value="MI">Michigan</option><option value="MN">Minnesota</option><option value="MS">Mississippi</option><option value="MO">Missouri</option><option value="MT">Montana</option><option value="NE">Nebraska</option><option value="NV">Nevada</option><option value="NH">New Hampshire</option><option value="NJ">New Jersey</option><option value="NM">New Mexico</option><option value="NY">New York</option><option value="NC">North Carolina</option><option value="ND">North Dakota</option><option value="OH">Ohio</option><option value="OK">Oklahoma</option><option value="OR">Oregon</option><option value="PA">Pennsylvania</option><option value="RI">Rhode Island</option><option value="SC">South Carolina</option><option value="SD">South Dakota</option><option value="TN">Tennessee</option><option value="TX">Texas</option><option value="UT">Utah</option><option value="VT">Vermont</option><option value="VA">Virginia</option><option value="WA">Washington</option><option value="WV">West Virginia</option><option value="WI">Wisconsin</option><option value="WY">Wyoming</option></select></div>
            <div><label>Upload Your 30-Second Video</label><input type="hidden" role="uploadcare-uploader" data-clearable="true" name="video_file" id="video-uploader" /></div>
            <div class="consent-group"><input type="checkbox" id="consents" name="consents" required><label for="consents">By checking this box, I confirm I am 18 years of age or older and I agree to receive event updates (which may include prizes and special offers) and to the <a href="YOUR_TERMS_PAGE_URL_HERE" target="_blank" rel="noopener noreferrer">Terms, Conditions & Privacy</a>.</label></div>
        </fieldset>
        <fieldset>
            <legend>Optional Information</legend>
            <p class="form-blurb">This information is a huge help for us in planning future events and understanding our community. We appreciate you taking a moment to share!</p>
            <div><label for="phone">Phone Number <span class="optional-label">(for event updates via text)</span></label><input type="tel" id="phone" name="phone"></div>
            <div><label for="tiktok">TikTok Handle</label><input type="text" id="tiktok" name="tiktok" placeholder="@yourhandle"></div>
            <div><label for="instagram">Instagram Handle</label><input type="text" id="instagram" name="instagram" placeholder="@yourhandle"></div>
            <div><label for="source">How did you hear about us?</label><select id="source" name="source"><option value="">Please select an option</option><option value="Friend">Friend sent link to website</option><option value="TikTok">TikTok</option><option value="Instagram">Instagram</option><option value="Facebook">Facebook</option></select></div>
        </fieldset>
        <button type="submit" id="submit-button">Submit My Entry</button>
    </form>
    <div id="status"></div>
    <script>
        const UPLOADCARE_PUBLIC_KEY = '2ae8933e05380119b824';
        const LAMBDA_ENDPOINT = 'https://2kotlptgbomtpbavljmljv65v40nuppq.lambda-url.us-east-2.on.aws/';
        
        document.addEventListener('DOMContentLoaded', () => { const params = new URLSearchParams(window.location.search); const email = params.get('email'); if (email) { document.getElementById('email').value = email; } });
        
        const widget = uploadcare.Widget('#video-uploader', { publicKey: UPLOADCARE_PUBLIC_KEY, });
        const form = document.getElementById('contest-form');
        const submitButton = document.getElementById('submit-button');
        const statusDiv = document.getElementById('status');
        
        form.addEventListener('submit', async function(event) {
            event.preventDefault();
            submitButton.disabled = true; submitButton.innerText = 'Submitting...'; statusDiv.style.display = 'none';
            
            // --- START: JavaScript Change ---
            const firstName = document.getElementById('firstName').value;
            const lastName = document.getElementById('lastName').value;
            // --- END: JavaScript Change ---
            
            const email = document.getElementById('email').value;
            const city = document.getElementById('city').value;
            const state = document.getElementById('state').value;
            const phone = document.getElementById('phone').value;
            const tiktok = document.getElementById('tiktok').value;
            const instagram = document.getElementById('instagram').value;
            const source = document.getElementById('source').value;
            const consents = document.getElementById('consents').checked;
            
            const uploaderInput = document.getElementById('video-uploader');
            const cdnUrl = uploaderInput.value;
            let fileUUID = null;
            if (cdnUrl) { const urlParts = cdnUrl.split('/'); if (urlParts.length > 3) { fileUUID = urlParts[3]; } }
            if (!fileUUID) { showStatus('Please upload a video file.', 'error'); submitButton.disabled = false; submitButton.innerText = 'Submit My Entry'; return; }
            if (!email) { showStatus('Email address is missing. Please ensure you used the link from your registration email.', 'error'); submitButton.disabled = false; submitButton.innerText = 'Submit My Entry'; return; }
            
            // --- START: Payload Change ---
            const payload = { 
                firstName: firstName, 
                lastName: lastName, 
                email: email, 
                city: city, 
                state: state, 
                phone: phone, 
                tiktokHandle: tiktok, 
                instagramHandle: instagram, 
                source: source, 
                fileUUID: fileUUID, 
                consentsAgreed: consents 
            };
            // --- END: Payload Change ---
            
            try {
                const response = await fetch(LAMBDA_ENDPOINT, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(payload), });
                if (response.ok) { showStatus('Success! Your entry has been received. Thank you!', 'success'); form.reset(); widget.value(null); } else { const errorData = await response.json(); showStatus(`Error: ${errorData.message || 'Could not submit your entry.'}`, 'error'); submitButton.disabled = false; submitButton.innerText = 'Submit My Entry'; }
            } catch (error) { console.error('Submission error:', error); showStatus('A network error occurred. Please try again.', 'error'); submitButton.disabled = false; submitButton.innerText = 'Submit My Entry'; }
        });
        function showStatus(message, type) { statusDiv.className = type; statusDiv.innerText = message; statusDiv.style.display = 'block'; }
    </script>
</body>
</html>
